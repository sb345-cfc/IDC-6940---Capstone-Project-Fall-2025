{"title":"Models","markdown":{"yaml":{"title":"Models"},"headingText":"Model Formula","containsRefs":false,"markdown":"\n\nThis section describes the development of the six supervised machine-learning models used to predict stroke occurrence. All models were trained using the **caret** package with the same repeated 5-fold cross-validation structure and ROC-based optimization.\n\n---\n\n\nAll models used the same predictor formula:\n\n```r\nmodel_formula <- stroke ~ age + gender + hypertension + heart_disease +\n                 ever_married + work_type + residence_type +\n                 avg_glucose_level + bmi + smoking_status\n\n\nCross-Validation Setup\n\nctrl <- trainControl(\n  method = \"repeatedcv\",\n  number = 5,\n  repeats = 3,\n  classProbs = TRUE,\n  summaryFunction = twoClassSummary\n)\nThis ensures fair comparison across all models.\n\n1. Logistic Regression\n\nset.seed(123)\nfit_glm <- train(\n  model_formula,\n  data = train_data,\n  method = \"glm\",\n  family = \"binomial\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_glm\n\nKey Findings\n\n- ROC ≈ 0.8456\n\n- Sensitivity = very low (model predicts almost all “No stroke”)\n\n- Specificity ≈ 1.00\n\n- AUC ≈ 0.8167\n\n- Age, Hypertension, and Glucose Level were the most important predictors.\n\nvarImp(fit_glm)\n\nLogistic regression performed well in terms of ROC, but class imbalance caused it to miss most stroke cases.\n\n2. Decision Tree (rpart)\n\nset.seed(123)\nfit_rpart <- train(\n  model_formula,\n  data = train_data,\n  method = \"rpart\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_rpart\n\nKey Findings\n\n- ROC ≈ 0.738\n\n- Sensitivity slightly higher than other simple models\n\n- Top predictors: Age, Hypertension, Glucose Level\n\nPlot the tree:\nrpart.plot(fit_rpart$finalModel)\n\nDecision trees are interpretable but struggle with imbalanced data.\n\n3. Gradient Boosted Machine (GBM)\nset.seed(123)\nfit_gbm <- train(\n  model_formula,\n  data = train_data,\n  method = \"gbm\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  verbose = FALSE\n)\nfit_gbm\n\nKey Findings\n\n- ROC ≈ 0.845 (highest among all models)\n\n- AUC ≈ 0.810\n\n- Strong classifier, but low sensitivity due to rare stroke cases\n\nMost important predictors:\n\n- Age\n\n- Average Glucose\n\n- Hypertension\n\nvarImp(fit_gbm)\n\nGBM showed the best discriminative power in your project.\n\n4. Random Forest\nset.seed(123)\nfit_rf <- train(\n  model_formula,\n  data = train_data,\n  method = \"rf\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_rf\n\nKey Findings\n\n- ROC ≈ 0.821\n\n- AUC ≈ 0.805\n\n- Sensitivity still low\n\nVariable importance ranks:\n\n- Glucose\n\n- BMI\n\n- Age\n\nvarImp(fit_rf)\n\n5. k-Nearest Neighbors (kNN)\n\nset.seed(123)\nfit_knn <- train(\n  model_formula,\n  data = train_data,\n  method = \"knn\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  preProcess = c(\"center\", \"scale\")\n)\nfit_knn\n\nKey Findings\n\n- ROC increases slightly with larger k\n\n- AUC ≈ 0.678\n\n- Predicted No stroke for all cases (0% sensitivity)\n\n- kNN struggles heavily with imbalanced datasets.\n\n6. Support Vector Machine (Radial Kernel)\nset.seed(123)\nfit_svm <- train(\n  model_formula,\n  data = train_data,\n  method = \"svmRadial\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  preProcess = c(\"center\", \"scale\")\n)\nfit_svm\n\nKey Findings\n\n- AUC ≈ 0.639\n\n- High accuracy but 0% sensitivity\n\n- Predicted all cases as “No stroke”\n\n- SVM performed poorly on this dataset due to the rarity of stroke events.\n\nSummary of All Models\n\nGBM and Random Forest were the strongest models in terms of AUC and ROC.\n\nLogistic Regression also performed surprisingly well but still struggled with identifying positive stroke cases.\n\nSimple classifiers (kNN, SVM, Decision Tree) had weaker performance due to data imbalance.\n\nROC Curves for All Models\nplot(res_glm$roc_obj, col=\"black\", lwd=2, main=\"ROC Curves (6 Models)\")\nplot(res_rpart$roc_obj, col=\"orange\", lwd=2, add=TRUE)\nplot(res_rf$roc_obj, col=\"red\", lwd=2, add=TRUE)\nplot(res_gbm$roc_obj, col=\"blue\", lwd=2, add=TRUE)\nplot(res_knn$roc_obj, col=\"brown\", lwd=2, add=TRUE)\nplot(res_svm$roc_obj, col=\"darkgreen\", lwd=2, add=TRUE)\n\nConclusion\n\n- GBM had the highest AUC and ROC performance.\n\n- Random Forest closely followed.\n\n- Logistic Regression performed moderately well.\n\n- Decision Tree, kNN, and SVM performed poorly due to imbalance.\n\n\n","srcMarkdownNoYaml":"\n\nThis section describes the development of the six supervised machine-learning models used to predict stroke occurrence. All models were trained using the **caret** package with the same repeated 5-fold cross-validation structure and ROC-based optimization.\n\n---\n\n# Model Formula\n\nAll models used the same predictor formula:\n\n```r\nmodel_formula <- stroke ~ age + gender + hypertension + heart_disease +\n                 ever_married + work_type + residence_type +\n                 avg_glucose_level + bmi + smoking_status\n\n\nCross-Validation Setup\n\nctrl <- trainControl(\n  method = \"repeatedcv\",\n  number = 5,\n  repeats = 3,\n  classProbs = TRUE,\n  summaryFunction = twoClassSummary\n)\nThis ensures fair comparison across all models.\n\n1. Logistic Regression\n\nset.seed(123)\nfit_glm <- train(\n  model_formula,\n  data = train_data,\n  method = \"glm\",\n  family = \"binomial\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_glm\n\nKey Findings\n\n- ROC ≈ 0.8456\n\n- Sensitivity = very low (model predicts almost all “No stroke”)\n\n- Specificity ≈ 1.00\n\n- AUC ≈ 0.8167\n\n- Age, Hypertension, and Glucose Level were the most important predictors.\n\nvarImp(fit_glm)\n\nLogistic regression performed well in terms of ROC, but class imbalance caused it to miss most stroke cases.\n\n2. Decision Tree (rpart)\n\nset.seed(123)\nfit_rpart <- train(\n  model_formula,\n  data = train_data,\n  method = \"rpart\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_rpart\n\nKey Findings\n\n- ROC ≈ 0.738\n\n- Sensitivity slightly higher than other simple models\n\n- Top predictors: Age, Hypertension, Glucose Level\n\nPlot the tree:\nrpart.plot(fit_rpart$finalModel)\n\nDecision trees are interpretable but struggle with imbalanced data.\n\n3. Gradient Boosted Machine (GBM)\nset.seed(123)\nfit_gbm <- train(\n  model_formula,\n  data = train_data,\n  method = \"gbm\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  verbose = FALSE\n)\nfit_gbm\n\nKey Findings\n\n- ROC ≈ 0.845 (highest among all models)\n\n- AUC ≈ 0.810\n\n- Strong classifier, but low sensitivity due to rare stroke cases\n\nMost important predictors:\n\n- Age\n\n- Average Glucose\n\n- Hypertension\n\nvarImp(fit_gbm)\n\nGBM showed the best discriminative power in your project.\n\n4. Random Forest\nset.seed(123)\nfit_rf <- train(\n  model_formula,\n  data = train_data,\n  method = \"rf\",\n  trControl = ctrl,\n  metric = \"ROC\"\n)\nfit_rf\n\nKey Findings\n\n- ROC ≈ 0.821\n\n- AUC ≈ 0.805\n\n- Sensitivity still low\n\nVariable importance ranks:\n\n- Glucose\n\n- BMI\n\n- Age\n\nvarImp(fit_rf)\n\n5. k-Nearest Neighbors (kNN)\n\nset.seed(123)\nfit_knn <- train(\n  model_formula,\n  data = train_data,\n  method = \"knn\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  preProcess = c(\"center\", \"scale\")\n)\nfit_knn\n\nKey Findings\n\n- ROC increases slightly with larger k\n\n- AUC ≈ 0.678\n\n- Predicted No stroke for all cases (0% sensitivity)\n\n- kNN struggles heavily with imbalanced datasets.\n\n6. Support Vector Machine (Radial Kernel)\nset.seed(123)\nfit_svm <- train(\n  model_formula,\n  data = train_data,\n  method = \"svmRadial\",\n  trControl = ctrl,\n  metric = \"ROC\",\n  preProcess = c(\"center\", \"scale\")\n)\nfit_svm\n\nKey Findings\n\n- AUC ≈ 0.639\n\n- High accuracy but 0% sensitivity\n\n- Predicted all cases as “No stroke”\n\n- SVM performed poorly on this dataset due to the rarity of stroke events.\n\nSummary of All Models\n\nGBM and Random Forest were the strongest models in terms of AUC and ROC.\n\nLogistic Regression also performed surprisingly well but still struggled with identifying positive stroke cases.\n\nSimple classifiers (kNN, SVM, Decision Tree) had weaker performance due to data imbalance.\n\nROC Curves for All Models\nplot(res_glm$roc_obj, col=\"black\", lwd=2, main=\"ROC Curves (6 Models)\")\nplot(res_rpart$roc_obj, col=\"orange\", lwd=2, add=TRUE)\nplot(res_rf$roc_obj, col=\"red\", lwd=2, add=TRUE)\nplot(res_gbm$roc_obj, col=\"blue\", lwd=2, add=TRUE)\nplot(res_knn$roc_obj, col=\"brown\", lwd=2, add=TRUE)\nplot(res_svm$roc_obj, col=\"darkgreen\", lwd=2, add=TRUE)\n\nConclusion\n\n- GBM had the highest AUC and ROC performance.\n\n- Random Forest closely followed.\n\n- Logistic Regression performed moderately well.\n\n- Decision Tree, kNN, and SVM performed poorly due to imbalance.\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"models.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","theme":"cosmo","toc-location":"left","title":"Models"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}